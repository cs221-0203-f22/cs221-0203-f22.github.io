<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Lab08 - Using UDP to Broadcast Presence | CS 221 - C and Systems Programming</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Lab08 - Using UDP to Broadcast Presence" />
<meta name="author" content="Phil Peterson" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Requirements In this lab, you will evolve the code you wrote to poll stdin You will use material presented in lecture to Use UDP broadcast to tell all computers on the lab network that you are online and ready to chat Poll port 8221 for broadcast UDP broadcast messages from other computers on the network Maintain a data structure with the user name, port, and online/offline status Every UDP presence message must include the following infomation, in this order: username status port Behavior requirements You must use your USF username (e.g. phpeterson) for presence and chat messages – no pseudonyms You must use the network in accordance with the USF’s Technology Resources Appropriate Use Policy" />
<meta property="og:description" content="Requirements In this lab, you will evolve the code you wrote to poll stdin You will use material presented in lecture to Use UDP broadcast to tell all computers on the lab network that you are online and ready to chat Poll port 8221 for broadcast UDP broadcast messages from other computers on the network Maintain a data structure with the user name, port, and online/offline status Every UDP presence message must include the following infomation, in this order: username status port Behavior requirements You must use your USF username (e.g. phpeterson) for presence and chat messages – no pseudonyms You must use the network in accordance with the USF’s Technology Resources Appropriate Use Policy" />
<meta property="og:site_name" content="CS 221 - C and Systems Programming" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-12-09T19:02:25+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Lab08 - Using UDP to Broadcast Presence" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Phil Peterson"},"headline":"Lab08 - Using UDP to Broadcast Presence","dateModified":"2022-12-09T19:02:25+00:00","datePublished":"2022-12-09T19:02:25+00:00","description":"Requirements In this lab, you will evolve the code you wrote to poll stdin You will use material presented in lecture to Use UDP broadcast to tell all computers on the lab network that you are online and ready to chat Poll port 8221 for broadcast UDP broadcast messages from other computers on the network Maintain a data structure with the user name, port, and online/offline status Every UDP presence message must include the following infomation, in this order: username status port Behavior requirements You must use your USF username (e.g. phpeterson) for presence and chat messages – no pseudonyms You must use the network in accordance with the USF’s Technology Resources Appropriate Use Policy","url":"/assignments/lab08.html","mainEntityOfPage":{"@type":"WebPage","@id":"/assignments/lab08.html"},"@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="CS 221 - C and Systems Programming" /><head>
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">  
</head>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">CS 221 - C and Systems Programming</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/syllabus/">Syllabus</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper"><h1 class="page-heading">Lab08 - Using UDP to Broadcast Presence</h1><div class="container">
  Due: 
  <span class="due-date">
    Tue, Nov 29, 2022 at 11:59 PM 
  </span>
  to <a href="https://classroom.github.com/a/fLOAZUkS">Github Classroom Assignment</a>
  <hr>
  <section id="main_content">
    <h2 id="requirements">Requirements</h2>
<ol>
  <li>In this lab, you will evolve the code you wrote to poll <code class="language-plaintext highlighter-rouge">stdin</code></li>
  <li>You will use material presented in lecture to
    <ol>
      <li>Use UDP broadcast to tell all computers on the lab network that you are online and ready to chat</li>
      <li>Poll port 8221 for broadcast UDP broadcast messages from other computers on the network</li>
      <li>Maintain a data structure with the user name, port, and online/offline status</li>
    </ol>
  </li>
  <li>Every UDP presence message must include the following infomation, in this order: <code class="language-plaintext highlighter-rouge">username status port</code></li>
  <li>Behavior requirements
    <ol>
      <li>You must use your USF username (e.g. phpeterson) for presence and chat messages – no pseudonyms</li>
      <li>You must use the network in accordance with the USF’s <a href="https://usf.service-now.com/usf?id=usf_kb_article&amp;sys_id=49f4ed8b1bc7f890345a0dc8cc4bcb98">Technology Resources Appropriate Use Policy</a></li>
    </ol>
  </li>
</ol>

<h2 id="given">Given</h2>
<ol>
  <li>In preparation for sending and receiving actual chat messages, I am providing a <a href="https://docs.google.com/spreadsheets/d/1t192niRJdXrSLps2SUOoP1_J5lSUjNb7Z_V2oYH8iIw/edit#gid=745709958">spreadsheet</a> which assigns two TCP ports to each student</li>
  <li>You will not need to do anything with the TCP port in this lab. For this lab, we are simply recording the TCP port which is provided in every UDP presence message</li>
</ol>

<h2 id="implementation-guide">Implementation Guide</h2>
<ol>
  <li>To initialize a socket to read and write UDP messages, you’ll need to
    <ol>
      <li>Use <code class="language-plaintext highlighter-rouge">getaddrinfo()</code> to request an <code class="language-plaintext highlighter-rouge">addrinfo</code> which supports the required “hints”</li>
      <li>Use <code class="language-plaintext highlighter-rouge">socket()</code> to create a file descriptor for the <code class="language-plaintext highlighter-rouge">addrinfo</code> returned from <code class="language-plaintext highlighter-rouge">getaddrinfo()</code></li>
      <li>Use <code class="language-plaintext highlighter-rouge">setsockopt()</code> to enable these options on the file descriptor: <code class="language-plaintext highlighter-rouge">SO_BROADCAST</code>, <code class="language-plaintext highlighter-rouge">SO_REUSEADDR</code>, <code class="language-plaintext highlighter-rouge">SO_REUSEPORT</code></li>
      <li>Use <code class="language-plaintext highlighter-rouge">bind()</code> to associate the file descriptor with the address you got from <code class="language-plaintext highlighter-rouge">getaddrinfo()</code></li>
    </ol>
  </li>
  <li>To write presence information to the presence file descriptor, you’ll need to
    <ol>
      <li>Format a buffer using the username, online/offline status, and TCP port number</li>
      <li>Construct a <code class="language-plaintext highlighter-rouge">sockaddr_in</code> using the broadcast address for the CS Labs network</li>
      <li>Use <code class="language-plaintext highlighter-rouge">sendto()</code> to send the buffer to the <code class="language-plaintext highlighter-rouge">sockaddr_in</code></li>
    </ol>
  </li>
  <li>To read presence information from the presence file descriptor, you’ll need to
    <ol>
      <li>Use <code class="language-plaintext highlighter-rouge">recvfrom()</code> to read from the socket into a buffer</li>
      <li>Scan through the buffer to populate the name, online/offline status, and port number. You may use <code class="language-plaintext highlighter-rouge">sscanf()</code> if you wish.</li>
    </ol>
  </li>
  <li>You should maintain a data structure (such as an array or linked list) which stores the information about each user
    <ol>
      <li>When a user changes online/offline status, you should record that information</li>
    </ol>
  </li>
  <li>Development tips
    <ol>
      <li>I suggest adding a verbose mode (<code class="language-plaintext highlighter-rouge">-v</code> or similar) so you can <code class="language-plaintext highlighter-rouge">printf()</code> what your program is doing as it runs</li>
      <li>Remember to check for errors and use <code class="language-plaintext highlighter-rouge">perror()</code></li>
    </ol>
  </li>
</ol>

<h2 id="rubric">Rubric</h2>
<ol>
  <li>50 pts: sends online/offline status so that my solution can see it</li>
  <li>50 pts: reads online/offline status from other users</li>
  <li>Unfortunately autograder is not sophisticated enough to grade this work, so we’ll do it by hand.</li>
</ol>

  </section>
</div>

      </div>
    </main>

  </body>

</html>
